!function t(e,n,r){function i(s,a){if(!n[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var h=n[s]={exports:{}};e[s][0].call(h.exports,function(t){var n=e[s][1][t];return i(n?n:t)},h,h.exports,t,e,n,r)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(t,e,n){"use strict";var r=t("number-is-nan");e.exports=Number.isFinite||function(t){return!("number"!=typeof t||r(t)||t===1/0||t===-(1/0))}},{"number-is-nan":3}],2:[function(t,e,n){"use strict";var r=t("is-finite");e.exports=Number.isInteger||function(t){return r(t)&&Math.floor(t)===t}},{"is-finite":1}],3:[function(t,e,n){"use strict";e.exports=Number.isNaN||function(t){return t!==t}},{}],4:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=t("./util/event-emitter"),u=t("./util/object-is"),l=t("./util/type-error-message"),h=function(t){function e(t,n){var o=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],s=arguments.length<=3||void 0===arguments[3]?{}:arguments[3];if(r(this,e),!u.ofType(t,"object")||Array.isArray(t))throw new TypeError(l.getObjectMessage(t));if(!1 in t||!1 in t)throw new Error(t+" should have x and y property");var a=i(this,Object.getPrototypeOf(e).call(this));return a.buttonElement=document.createElement("button"),a.buttonElement.classList.add("taggd__button"),a.popupElement=document.createElement("span"),a.popupElement.classList.add("taggd__popup"),a.buttonElement.appendChild(a.popupElement),a.isControlsEnabled=!1,a.inputLabelElement=void 0,a.buttonSaveElement=void 0,a.buttonDeleteElement=void 0,a.buttonSaveElementClickHandler=function(){return a.setText(a.inputLabelElement.value)},a.buttonDeleteElementClickHandler=function(){a.emit("taggd.tag.delete",a)},a.text=void 0,a.setButtonAttributes(o),a.setPopupAttributes(s),a.setPosition(t.x,t.y),a.setText(n),a.hide(),a}return o(e,t),s(e,[{key:"show",value:function(){var t=!this.emit("taggd.tag.show",this);return t||(this.popupElement.style.display="",this.emit("taggd.tag.shown",this)),this}},{key:"hide",value:function(){var t=!this.emit("taggd.tag.hide",this);return t||(this.popupElement.style.display="none",this.emit("taggd.tag.hidden",this)),this}},{key:"setText",value:function(t){if(!u.ofType(t,"string")&&!u["function"](t))throw new TypeError(l.getMessage(type,"a string or a function"));var e=!this.emit("taggd.tag.change",this);return e||(u["function"](t)?this.text=t(this):this.text=t,this.isControlsEnabled?this.inputLabelElement.value=this.text:this.popupElement.innerHTML=this.text,this.emit("taggd.tag.changed",this)),this}},{key:"setPosition",value:function(t,n){if(!u.number(t))throw new TypeError(l.getFloatMessage(t));if(!u.number(n))throw new TypeError(l.getFloatMessage(n));var r=!this.emit("taggd.tag.change",this);if(!r){var i=e.getPositionStyle(t,n);this.buttonElement.style.left=i.left,this.buttonElement.style.top=i.top,this.emit("taggd.tag.changed",this)}return this}},{key:"setButtonAttributes",value:function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];if(!u.ofType(t,"object")||Array.isArray(t))throw new TypeError(l.getObjectMessage(t));var n=!this.emit("taggd.tag.change",this);return n||(e.setElementAttributes(this.buttonElement,t),this.emit("taggd.tag.changed",this)),this}},{key:"setPopupAttributes",value:function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];if(!u.ofType(t,"object")||Array.isArray(t))throw new TypeError(l.getObjectMessage(t));var n=!this.emit("taggd.tag.change",this);return n||(e.setElementAttributes(this.popupElement,t),this.emit("taggd.tag.changed",this)),this}},{key:"enableControls",value:function(){return this.isControlsEnabled=!0,this.inputLabelElement=document.createElement("input"),this.buttonSaveElement=document.createElement("button"),this.buttonDeleteElement=document.createElement("button"),this.inputLabelElement.classList.add("taggd__editor-input"),this.buttonSaveElement.classList.add("taggd__editor-button","taggd__editor-button--save"),this.buttonDeleteElement.classList.add("taggd__editor-button","taggd__editor-button--delete"),this.buttonSaveElement.innerHTML=e.LABEL_BUTTON_SAVE,this.buttonDeleteElement.innerHTML=e.LABEL_BUTTON_DELETE,this.buttonSaveElement.addEventListener("click",this.buttonSaveElementClickHandler),this.buttonDeleteElement.addEventListener("click",this.buttonDeleteElementClickHandler),this.popupElement.innerHTML="",this.popupElement.appendChild(this.inputLabelElement),this.popupElement.appendChild(this.buttonSaveElement),this.popupElement.appendChild(this.buttonDeleteElement),this.setText(this.text),this}},{key:"disableControls",value:function(){return this.isControlsEnabled=!1,this.inputLabelElement=void 0,this.buttonSaveElement=void 0,this.buttonDeleteElement=void 0,this.setText(this.text),this}},{key:"toJSON",value:function(){function t(t){var e={};return Array.prototype.forEach.call(t,function(t){"class"!==t.name&&"style"!==t.name&&(e[t.name]=t.value)}),e}return{position:{x:parseFloat(this.buttonElement.style.left)/100,y:parseFloat(this.buttonElement.style.left)/100},text:this.text,buttonAttributes:t(this.buttonElement.attributes),popupAttributes:t(this.popupElement.attributes)}}}],[{key:"setElementAttributes",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(!u.ofType(e,"object")||Array.isArray(e))throw new TypeError(l.getObjectMessage(e));for(var n in e){var r=e[n];if("class"===n&&t.getAttribute(n)){var i=t.getAttribute(n)+(" "+r);t.setAttribute(n,i)}else t.setAttribute(n,r)}return t}},{key:"getPositionStyle",value:function(t,e){if(!u.number(t))throw new TypeError(l.getFloatMessage(t));if(!u.number(e))throw new TypeError(l.getFloatMessage(e));return{left:100*t+"%",top:100*e+"%"}}},{key:"createFromObject",value:function(t){return new e(t.position,t.text,t.buttonAttributes,t.popupAttributes)}}]),e}(a);h.LABEL_NEW_TAG="New tag",h.LABEL_BUTTON_SAVE="save",h.LABEL_BUTTON_DELETE="delete",e.exports=h},{"./util/event-emitter":6,"./util/object-is":7,"./util/type-error-message":8}],5:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=t("./Tag"),l=t("./util/event-emitter"),h=t("./util/object-is"),c=t("./util/type-error-message");Number.isInteger=Number.isInteger||t("number-is-integer");var g=function(t){function e(t){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],o=arguments.length<=2||void 0===arguments[2]?[]:arguments[2];if(r(this,e),!t instanceof Element)throw new TypeError(c.getMessage(t,Element));var s=i(this,Object.getPrototypeOf(e).call(this));return s.wrapper=document.createElement("div"),s.wrapper.classList.add("taggd"),t.classList.add("taggd__image"),t.parentElement.insertBefore(s.wrapper,t),t.parentElement.removeChild(t),s.wrapper.appendChild(t),s.image=t,s.options={},s.tags=[],s.imageClickHandler=function(t){var e={x:t.clientX/s.image.width,y:t.clientY/s.image.height},n=new u(e,u.LABEL_NEW_TAG);n.enableControls(),s.addTag(n)},s.setOptions(n),s.setTags(o),s}return o(e,t),a(e,[{key:"setOptions",value:function(t){if(!h.ofType(t,"object")||Array.isArray(t))throw new TypeError(c.getObjectMessage(tag));return this.options=s(this.options,e.DEFAULT_OPTIONS,t),this}},{key:"addTag",value:function(t){var e=this;if(!h.ofInstance(t,u))throw new TypeError(c.getTagMessage(t));var n=!this.emit("taggd.tag.add",this,t);return n||(t.buttonElement.addEventListener(this.options.show,function(){return t.show()}),t.buttonElement.addEventListener(this.options.hide,function(){return t.hide()}),t.once("taggd.tag.delete",function(t){var n=e.tags.indexOf(t);n>=0&&e.deleteTag(n)}),t.onAnything(function(t){for(var n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];e.emit.apply(e,[t,e].concat(r))}),this.tags.push(t),this.wrapper.appendChild(t.buttonElement),this.emit("taggd.tag.added",this,t)),this}},{key:"getTag",value:function(t){if(!Number.isInteger(t))throw new TypeError(c.getIntegerMessage(t));return this.tags[t]}},{key:"deleteTag",value:function(t){if(!Number.isInteger(t))throw new TypeError(c.getIntegerMessage(t));if(!this.tags[t])throw new Error("Tag at index "+t+" does not exist.");var e=this.tags[t],n=!this.emit("taggd.tag.delete",this,e);return n||(this.wrapper.removeChild(e.buttonElement),this.tags.splice(t,1),this.emit("taggd.tag.deleted",this,e)),this}},{key:"setTags",value:function(t){return this.deleteTags(),this.addTags(t),this}},{key:"addTags",value:function(t){var e=this;if(!Array.isArray(t))throw new TypeError(c.getArrayMessage(t,"Taggd.Tag"));return t.forEach(function(t){return e.addTag(t)}),this}},{key:"getTags",value:function(){return this.tags}},{key:"deleteTags",value:function(){return this.tags.slice(0,this.tags.length),this}},{key:"map",value:function(t){if(!h["function"](t))throw new TypeError(c.getFunctionMessage(t));return this.tags=this.tags.map(t),this}},{key:"destroy",value:function(){var t=!this.emit("taggd.destroy",this);return t||this.deleteTags(),this}},{key:"enableEditorMode",value:function(){var t=!this.emit("taggd.editor.enable",this);return t||(this.image.addEventListener("click",this.imageClickHandler),this.getTags().forEach(function(t){return t.enableControls()})),this}},{key:"disableEditorMode",value:function(){var t=!this.emit("taggd.editor.disable",this);return t||(this.image.removeEventListener("click",this.imageClickHandler),this.getTags().forEach(function(t){return t.disableControls()})),this}}]),e}(l);g.DEFAULT_OPTIONS={show:"mouseenter",hide:"mouseleave"},e.exports=g,e.exports.Tag=u,window.Taggd=e.exports},{"./Tag":4,"./util/event-emitter":6,"./util/object-is":7,"./util/type-error-message":8,"number-is-integer":2}],6:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o="*",s=function(){function t(){r(this,t),this.handlers={}}return i(t,[{key:"onAnything",value:function(t){this.on(o,t)}},{key:"on",value:function(t,e){this.handlers[t]||(this.handlers[t]=[]),this.handlers[t].push(e)}},{key:"off",value:function(t,e){if(this.handlers[t]){var n=this.handlers[t].indexOf(e);n>=0&&this.handlers[t].splice(n,1)}}},{key:"once",value:function(t,e){var n=this;this.on(t,function(){e.apply(void 0,arguments),n.off(t,e)})}},{key:"emit",value:function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var i=!1;return this.handlers[o]&&this.handlers[o].forEach(function(e){var r=e.apply(void 0,[t].concat(n));i=void 0!==r&&!r||i}),this.handlers[t]&&this.handlers[t].forEach(function(t){var e=t.apply(void 0,n);i=void 0!==e&&!e||i}),!i}}]),t}();e.exports=s},{}],7:[function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};e.exports={ofInstance:function(t,e){return t instanceof e},ofType:function(t,e){return("undefined"==typeof t?"undefined":r(t))===e},"function":function(t){return"function"==typeof t},number:function(t){return!isNaN(parseFloat(t))}}},{}],8:[function(t,e,n){"use strict";var r={getMessage:function(t,e){return t+" should be "+e},getArrayMessage:function(t,e){return e?this.getTypeErrorMessage(t,"an array of "+e):this.getTypeErrorMessage(t,"an array")},getFunctionMessage:function(t){return this.getTypeErrorMessage(t,"a function")},getIntegerMessage:function(t){return this.getTypeErrorMessage(t,"an integer")},getFloatMessage:function(t){return this.getTypeErrorMessage(t,"a floating number")},getObjectMessage:function(t){return this.getTypeErrorMessage(t,"an object")},getTagMessage:function(t){return this.getTypeErrorMessage(t,"a tag")},getTypeErrorMessage:function(t,e){return t+" is not a "+e}};e.exports=r},{}]},{},[5]);
//# sourceMappingURL=taggd.min.js.map
